# Отборочное задание Авито Golang

## Запуск проекта

1. Клонировать репозиторий
2. Запустить `docker-compose up`
3. Сервис будет доступен на `http://localhost:8080`

## API методы

После запуска проекта по ручке http://localhost:8080/swagger-ui можно посмотреть документацию к API.

### Получение активных сегментов пользователя

- **Метод**: `GET`
- **URL**: `/v1/users`
- **Параметры запроса**:
    - `user_id` (обязательный)
- **Ответы**:
- `200 OK`:
  - `segments`: Массив названий и id сегментов.
    - `400 Bad Request`
    - `500 Internal Server Error`

### Добавление или удаление сегментов для пользователя

- **Метод**: `PATCH`
- **URL**: `/v1/users`
- **Тело запроса**: JSON объект:
    - `to_create`: Массив объектов:
        - `slug` (обязательный): Название сегмента
        - `ttl`: Дата и время, до которых сегмент будет активен для пользователя, в формате ISO 8601 ("2006-01-02T15:04:
          05Z").
    - `to_delete`: Массив названий сегментов, которые нужно удалить.
    - `user_id` (обязательный)

Пример тела запроса:

```json
{
  "to_create": [
    {
      "slug": "AVITO_VOICE_MESSAGES",
      "ttl": "2023-12-31T23:59:59Z"
    }
  ],
  "to_delete": [
    "AVITO_DISCOUNT_30"
  ],
  "user_id": "1000"
}
```

- **Ответы**:
    - `200 OK`
    - `400 Bad Request`
    - `500 Internal Server Error`

### Создание логов пользователя

- **Метод**: `POST`
- **URL**: `/v1/users/logs`
- **Тело запроса**:
    - `UserID` (обязательный): ID пользователя
    - `Date` (обязательный): Месяц и год в формате `YYYY-MM`
- **Ответы**:
    - `201 Created`Возвращает путь к файлу лога в контейнере. Название: id пользователя + дата
    - `400 Bad Request`
    - `500 Internal Server Error`

### Создание сегмента

- **Метод**: `POST`
- **URL**: `/v1/segments`
- **Тело запроса**:
    - `slug` (обязательный): Название сегмента
    - `percent`: Процент пользователей для автоматического добавления этого сегмента
- **Ответы**:
    - `201 Created`
    - `400 Bad Request`
    - `500 Internal Server Error`

### Удаление сегмента

- **Метод**: `DELETE`
- **URL**: `/v1/segments`
- **Параметры запроса**:
    - `slug` (обязательный): Название сегмента для удаления
- **Ответы**:
    - `200 OK`
    - `400 Bad Request`
    - `500 Internal Server Error`

## Дополнительные задания

1. **Логирование**

2. **TTL**

3. **Автоматическое добавление сегментов**

## Вопросы и решения

